name: AWS OIDC Connection Test

on:
    push:
        branches:
            - "feat/*"

permissions:
    id-token: write
    contents: read

jobs:
    aws-oidc-test:
        runs-on: ubuntu-latest
        environment: dev

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Configure AWS credentials (OIDC)
              uses: aws-actions/configure-aws-credentials@v4
              with:
                  role-to-assume: ${{ env.AWS_ROLE_TO_ASSUME }}
                  aws-region: ${{ env.AWS_REGION }}

            - name: Test AWS Connection
              run: aws sts get-caller-identity
